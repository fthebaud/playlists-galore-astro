---
import type { CollectionEntry } from "astro:content";
import { Image } from "astro:assets";
import TidalLogo from "@src/assets/tidal-icon.svg";
import DeezerLogo from "@src/assets/deezer-icon.svg";
import YoutubeMusicLogo from "@src/assets/youtubeMusic-icon.svg";
import SpotifyLogo from "@src/assets/spotify-icon.svg";

interface Props {
  playlist: CollectionEntry<"playlists">["data"];
}

const { playlist } = Astro.props;

const dateStr = playlist.lastUpdate.toString();
const formattedDate = new Date(
  parseInt(dateStr.substring(0, 4)), // Year
  parseInt(dateStr.substring(4, 6)) - 1, // Month (0-based index)
  parseInt(dateStr.substring(6, 8)), // Day
).toLocaleDateString("fr-FR");
---

<div class="container">
  <Image
    src={playlist.images[0].url}
    width={640}
    height={640}
    class="image-cover"
    alt="Playlist illustration made from a collage of the first four album covers"
    loading="eager"
  />
  <div>
    <div>{playlist.name}</div>
    <div class="info-details">
      {`${playlist.totalTracks} tracks, published: ${formattedDate}`}
    </div>
  </div>

  <div class="links">
    <a
      href={playlist.url.tidal}
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Tidal"
    >
      <TidalLogo />
    </a>
    <a
      href={playlist.url.deezer}
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Deezer"
    >
      <DeezerLogo />
    </a>
    <a
      href={playlist.url.youtube}
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Youtube Music"
    >
      <YoutubeMusicLogo />
    </a>
    <a
      href={playlist.url.spotify}
      target="_blank"
      rel="noopener noreferrer"
      aria-label="Spotify"
    >
      <SpotifyLogo />
    </a>
  </div>
</div>
<style>
  .container {
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  .image-cover {
    width: 100%;
    aspect-ratio: 1 / 1;
    border-radius: 12px;
    border: 1px solid;
    border-color: black;
  }

  html.dark .image-cover {
    border-color: white;
  }

  .info-details {
    font-size: 0.875rem;
    color: grey;
    font-style: italic;
  }

  .links {
    display: flex;
    justify-content: space-evenly;
  }

  .links a {
    width: 3.6rem;
    height: auto;
    display: block;
  }
</style>
